
unit Dal.ERP.efd_;

interface
uses
  System.SysUtils, System.Classes, Data.DB, ListError, Parameters,
  System.Generics.Defaults, System.Generics.Collections, Utilitarios,
  ModelBase, ModelBaseList, Model.ERP.efd_, DalBaseCRUD,
  SQLQuery;

type
  TDalERPefd = class(TDalBaseCRUD)
  private 
    FModel : TModelERPefd;  
    FModelList : TModelBaseList<TModelERPefd>; 
  public 

    function Delete(Model: TModelBase): Boolean; override; 
    function Insert(Model: TModelBase): Boolean; override; 
    function Select(Model : TModelBase; out ModelList : TModelBaseList<TModelBase> ) : Boolean; override;  
    function Update(Model: TModelBase): Boolean; override; 
  end; 

implementation

function TDalERPefd.Delete(Model: TModelBase): Boolean; 
begin                                                                   
  if not (Model is TModelERPefd) then                   
  begin                                                                 
    ListError.Insert('Data Acess Layer','Tipo de dado incorreto ou Modelo (%s) Não Inicializado!', Self.ClassName);  
    Result := (ListError.Count = 0);                                     
    Exit;                                                                
  end;                                                                   

  Self.FModel := ( Model as TModelERPefd );              

  if not Assigned( Self.FModel ) then  
  begin                                
    ListError.Insert('Data Acess Layer','Modelo (%s) Não Inicializado!', Self.ClassName); 
    Result := (ListError.Count = 0);   
    Exit;                              
  end;                                 

  if Self.FModel.id = 0 then  
  begin                       
    ListError.Insert('Exclusão de registros','Nenhum valor foi passado para o NCM!');  
    Result := (ListError.Count = 0);  
    Exit;                     
  end;                        
  SQL.DeleteFrom('ncm_regra_substituicao').Where('id').Equal( Self.FModel.id );  
  dbDelete;                                
  Result := (ListError.Count = 0);         
end;                                       

function TDalERPefd.Insert(Model: TModelBase): Boolean; 
 var teste:widestring;                                                   
begin                                                                    
  if not (Model is TModelERPefd) then                   
  begin                                                                  
    ListError.Insert('Data Acess Layer','Tipo de dado incorreto ou Modelo (%s) Não Inicializado!', Self.ClassName); 
    Result := (ListError.Count = 0);                                     
    Exit;                                                                
  end;                                                                   

  Self.FModel := ( Model as TModelERPefd ); 

  if not Assigned( Self.FModel ) then  
  begin                                
    ListError.Insert('Data Acess Layer','Modelo (%s) Não Inicializado!', Self.ClassName); 
    Result := (ListError.Count = 0);   
    Exit;                              
  end;                                 

  if not Self.FModel.Validate then 
  begin                            
    ListError.Assign( Self.FModel.ListError );  
    Result := (ListError.Count = 0);  
    Exit;                             
  end;                                
  SQL.Insert(empresas).Fields( Self.FModel.ToString ).Values; 
     SQL.Field(Self.FModel.id).Next;
     SQL.Field(Self.FModel.nome).Next;
     SQL.Field(Self.FModel.endereco).Next;
     SQL.Field(Self.FModel.cnpj).Next;
     SQL.Field(Self.FModel.inscricao_estadual).Next;
     SQL.Field(Self.FModel.fone1).Next;
     SQL.Field(Self.FModel.fone2).Next;
     SQL.Field(Self.FModel.fax).Next;
     SQL.Field(Self.FModel.bairro).Next;
     SQL.Field(Self.FModel.id_cidade).Next;
     SQL.Field(Self.FModel.uf).Next;
     SQL.Field(Self.FModel.representante_legal).Next;
     SQL.Field(Self.FModel.tipo_empresa).Next;
     SQL.Field(Self.FModel.hostname).Next;
     SQL.Field(Self.FModel.database).Next;
     SQL.Field(Self.FModel.porta).Next;
     SQL.Field(Self.FModel.usuariodbms).Next;
     SQL.Field(Self.FModel.senhadbms).Next;
     SQL.Field(Self.FModel.data_cadastro).Next;
     SQL.Field(Self.FModel.cta_vendas).Next;
     SQL.Field(Self.FModel.cta_compra).Next;
     SQL.Field(Self.FModel.cta_recparcela).Next;
     SQL.Field(Self.FModel.cta_estparcela).Next;
     SQL.Field(Self.FModel.cta_pagparcela).Next;
     SQL.Field(Self.FModel.cta_depbancario).Next;
     SQL.Field(Self.FModel.cta_emissaocheq).Next;
     SQL.Field(Self.FModel.cta_estcaixa).Next;
     SQL.Field(Self.FModel.cta_estbanco).Next;
     SQL.Field(Self.FModel.cta_jrorecebido).Next;
     SQL.Field(Self.FModel.cta_jropago).Next;
     SQL.Field(Self.FModel.cta_descrecebido).Next;
     SQL.Field(Self.FModel.cta_descpago).Next;
     SQL.Field(Self.FModel.cta_devolvenda).Next;
     SQL.Field(Self.FModel.desc_rateio).Next;
     SQL.Field(Self.FModel.mensagem_promocional).Next;
     SQL.Field(Self.FModel.modelo_duplicata).Next;
     SQL.Field(Self.FModel.modelo_recibo).Next;
     SQL.Field(Self.FModel.modelo_nota).Next;
     SQL.Field(Self.FModel.qtd_itensnota).Next;
     SQL.Field(Self.FModel.tam_pagnota).Next;
     SQL.Field(Self.FModel.seq_nronota).Next;
     SQL.Field(Self.FModel.imprime_nota).Next;
     SQL.Field(Self.FModel.imprime_vendedor).Next;
     SQL.Field(Self.FModel.estoque_negativo).Next;
     SQL.Field(Self.FModel.texto_cobranca).Next;
     SQL.Field(Self.FModel.custo_operacional).Next;
     SQL.Field(Self.FModel.custo_financeiro).Next;
     SQL.Field(Self.FModel.juro_dia).Next;
     SQL.Field(Self.FModel.cfop_avista).Next;
     SQL.Field(Self.FModel.cfop_aprazo).Next;
     SQL.Field(Self.FModel.click).Next;
     SQL.Field(Self.FModel.salto_nota).Next;
     SQL.Field(Self.FModel.caminho_nota).Next;
     SQL.Field(Self.FModel.cotacao).Next;
     SQL.Field(Self.FModel.comissao_decrescente).Next;
     SQL.Field(Self.FModel.intervalo_a1).Next;
     SQL.Field(Self.FModel.intervalo_a2).Next;
     SQL.Field(Self.FModel.intervalo_b1).Next;
     SQL.Field(Self.FModel.intervalo_b2).Next;
     SQL.Field(Self.FModel.intervalo_c1).Next;
     SQL.Field(Self.FModel.intervalo_c2).Next;
     SQL.Field(Self.FModel.intervalo_d1).Next;
     SQL.Field(Self.FModel.intervalo_d2).Next;
     SQL.Field(Self.FModel.intervalo_e1).Next;
     SQL.Field(Self.FModel.intervalo_f1).Next;
     SQL.Field(Self.FModel.intervalo_f2).Next;
     SQL.Field(Self.FModel.intervalo_g1).Next;
     SQL.Field(Self.FModel.intervalo_g2).Next;
     SQL.Field(Self.FModel.intervalo_h1).Next;
     SQL.Field(Self.FModel.intervalo_h2).Next;
     SQL.Field(Self.FModel.intervalo_i1).Next;
     SQL.Field(Self.FModel.intervalo_i2).Next;
     SQL.Field(Self.FModel.intervalo_j1).Next;
     SQL.Field(Self.FModel.intervalo_j2).Next;
     SQL.Field(Self.FModel.intervalo_l1).Next;
     SQL.Field(Self.FModel.intervalo_l2).Next;
     SQL.Field(Self.FModel.intervalo_m1).Next;
     SQL.Field(Self.FModel.intervalo_m2).Next;
     SQL.Field(Self.FModel.comissao_a).Next;
     SQL.Field(Self.FModel.comissao_b).Next;
     SQL.Field(Self.FModel.comissao_c).Next;
     SQL.Field(Self.FModel.comissao_d).Next;
     SQL.Field(Self.FModel.comissao_e).Next;
     SQL.Field(Self.FModel.comissao_f).Next;
     SQL.Field(Self.FModel.comissao_g).Next;
     SQL.Field(Self.FModel.comissao_h).Next;
     SQL.Field(Self.FModel.comissao_i).Next;
     SQL.Field(Self.FModel.comissao_j).Next;
     SQL.Field(Self.FModel.comissao_l).Next;
     SQL.Field(Self.FModel.comissao_m).Next;
     SQL.Field(Self.FModel.intervalo_e2).Next;
     SQL.Field(Self.FModel.salto_duplicata).Next;
     SQL.Field(Self.FModel.imagem).Next;
     SQL.Field(Self.FModel.arquivo_imagem).Next;
     SQL.Field(Self.FModel.produto_conjugado).Next;
     SQL.Field(Self.FModel.rateio_comissao).Next;
     SQL.Field(Self.FModel.cta_vendas_aprazo).Next;
     SQL.Field(Self.FModel.formacao_preco).Next;
     SQL.Field(Self.FModel.nosso_numero).Next;
     SQL.Field(Self.FModel.identifica_cupom).Next;
     SQL.Field(Self.FModel.atividade).Next;
     SQL.Field(Self.FModel.venda_rapida).Next;
     SQL.Field(Self.FModel.grade).Next;
     SQL.Field(Self.FModel.data_analise).Next;
     SQL.Field(Self.FModel.cta_suprimento).Next;
     SQL.Field(Self.FModel.cta_sangria).Next;
     SQL.Field(Self.FModel.cta_os).Next;
     SQL.Field(Self.FModel.bancocodigo).Next;
     SQL.Field(Self.FModel.banconome).Next;
     SQL.Field(Self.FModel.cedentecodigo).Next;
     SQL.Field(Self.FModel.cedentecodigodigito).Next;
     SQL.Field(Self.FModel.carteira).Next;
     SQL.Field(Self.FModel.agenciacodigo).Next;
     SQL.Field(Self.FModel.agenciadigito).Next;
     SQL.Field(Self.FModel.agencianome).Next;
     SQL.Field(Self.FModel.contanumero).Next;
     SQL.Field(Self.FModel.contanumerodigito).Next;
     SQL.Field(Self.FModel.proximonossonumero).Next;
     SQL.Field(Self.FModel.salto_etiqueta1).Next;
     SQL.Field(Self.FModel.salto_etiqueta2).Next;
     SQL.Field(Self.FModel.salto_etiqueta3).Next;
     SQL.Field(Self.FModel.salto_etiqueta4).Next;
     SQL.Field(Self.FModel.filtro_nome).Next;
     SQL.Field(Self.FModel.dir_sistema).Next;
     SQL.Field(Self.FModel.dir_banco).Next;
     SQL.Field(Self.FModel.valorreceber_maior).Next;
     SQL.Field(Self.FModel.cfop_devolucao).Next;
     SQL.Field(Self.FModel.devolucao_financeiro).Next;
     SQL.Field(Self.FModel.vendedor_venda).Next;
     SQL.Field(Self.FModel.instrucoes).Next;
     SQL.Field(Self.FModel.forma_boleto).Next;
     SQL.Field(Self.FModel.cupom_automatico).Next;
     SQL.Field(Self.FModel.simples).Next;
     SQL.Field(Self.FModel.vl_enc_federal).Next;
     SQL.Field(Self.FModel.vl_enc_estadual).Next;
     SQL.Field(Self.FModel.convenio).Next;
     SQL.Field(Self.FModel.tipo_convenio).Next;
     SQL.Field(Self.FModel.dir_backup).Next;
     SQL.Field(Self.FModel.modelo_carne).Next;
     SQL.Field(Self.FModel.iss).Next;
     SQL.Field(Self.FModel.qtd_itensnotaservico).Next;
     SQL.Field(Self.FModel.texto_aniversario).Next;
     SQL.Field(Self.FModel.ordemproc_produto).Next;
     SQL.Field(Self.FModel.extrato_produto).Next;
     SQL.Field(Self.FModel.boleto).Next;
     SQL.Field(Self.FModel.salto_boleto).Next;
     SQL.Field(Self.FModel.cliente_coringa).Next;
     SQL.Field(Self.FModel.mostra_conta).Next;
     SQL.Field(Self.FModel.numero).Next;
     SQL.Field(Self.FModel.cep).Next;
     SQL.Field(Self.FModel.responsavel).Next;
     SQL.Field(Self.FModel.st).Next;
     SQL.Field(Self.FModel.ipi).Next;
     SQL.Field(Self.FModel.industria).Next;
     SQL.Field(Self.FModel.locacao).Next;
     SQL.Field(Self.FModel.obs_orcamento).Next;
     SQL.Field(Self.FModel.insc_mun).Next;
     SQL.Field(Self.FModel.nfe).Next;
     SQL.Field(Self.FModel.supervisor).Next;
     SQL.Field(Self.FModel.salto_etiqueta5).Next;
     SQL.Field(Self.FModel.juro_carencia).Next;
     SQL.Field(Self.FModel.baixa_simples).Next;
     SQL.Field(Self.FModel.obs_carne1).Next;
     SQL.Field(Self.FModel.obs_carne2).Next;
     SQL.Field(Self.FModel.obs_carne3).Next;
     SQL.Field(Self.FModel.obs_carne4).Next;
     SQL.Field(Self.FModel.obs_carne5).Next;
     SQL.Field(Self.FModel.obs_carne6).Next;
     SQL.Field(Self.FModel.venda_maior).Next;
     SQL.Field(Self.FModel.substituto_tributario).Next;
     SQL.Field(Self.FModel.diretorio_fotos).Next;
     SQL.Field(Self.FModel.obs_carne7).Next;
     SQL.Field(Self.FModel.obs_carne8).Next;
     SQL.Field(Self.FModel.modelo_ficha).Next;
     SQL.Field(Self.FModel.pis).Next;
     SQL.Field(Self.FModel.cofins).Next;
     SQL.Field(Self.FModel.ajusta_fatura).Next;
     SQL.Field(Self.FModel.simples_nacional).Next;
     SQL.Field(Self.FModel.produto_consulta).Next;
     SQL.Field(Self.FModel.modelo_orcamento).Next;
     SQL.Field(Self.FModel.modelo_expedicao).Next;
     SQL.Field(Self.FModel.dias_backup).Next;
     SQL.Field(Self.FModel.imprime_notad1).Next;
     SQL.Field(Self.FModel.farmacia_popular).Next;
     SQL.Field(Self.FModel.fpb).Next;
     SQL.Field(Self.FModel.irpj).Next;
     SQL.Field(Self.FModel.cont_social).Next;
     SQL.Field(Self.FModel.casas_decimais).Next;
     SQL.Field(Self.FModel.tipo_desconto).Next;
     SQL.Field(Self.FModel.custo_servico).Next;
     SQL.Field(Self.FModel.tipo_juro_venda).Next;
     SQL.Field(Self.FModel.bloqueio_automatico).Next;
     SQL.Field(Self.FModel.controle_caixa).Next;
     SQL.Field(Self.FModel.tipo_juro).Next;
     SQL.Field(Self.FModel.aproveitamento_credito_atacado).Next;
     SQL.Field(Self.FModel.icms_saida).Next;
     SQL.Field(Self.FModel.compras_red_fora).Next;
     SQL.Field(Self.FModel.compras_red_dentro).Next;
     SQL.Field(Self.FModel.atacado).Next;
     SQL.Field(Self.FModel.aprazo).Next;
     SQL.Field(Self.FModel.id_tabela_preco).Next;
     SQL.Field(Self.FModel.multa).Next;
     SQL.Field(Self.FModel.tributado).Next;
     SQL.Field(Self.FModel.substituicao).Next;
     SQL.Field(Self.FModel.isento).Next;
     SQL.Field(Self.FModel.reducao).Next;
     SQL.Field(Self.FModel.credencial).Next;
     SQL.Field(Self.FModel.controleestoquevenda).Next;
     SQL.Field(Self.FModel.cta_transf_saida).Next;
     SQL.Field(Self.FModel.cta_transf_entrada).Next;
     SQL.Field(Self.FModel.cta_estorno_emissao_cheque).Next;
     SQL.Field(Self.FModel.cta_custodia).Next;
     SQL.Field(Self.FModel.cta_estorno_custodia).Next;
     SQL.Field(Self.FModel.cta_juros_custodia).Next;
     SQL.Field(Self.FModel.cta_estorno_juros_custodia).Next;
     SQL.Field(Self.FModel.cta_estorno_pagamento).Next;
     SQL.Field(Self.FModel.cta_taxa_juros).Next;
     SQL.Field(Self.FModel.razao_social).Next;
     SQL.Field(Self.FModel.celular).Next;
     SQL.Field(Self.FModel.contato).Next;
     SQL.Field(Self.FModel.parceiro).Next;
     SQL.Field(Self.FModel.cta_recebimento_cartao).Next;
     SQL.Field(Self.FModel.obs_promissoria).Next;
     SQL.Field(Self.FModel.boleto_novo).Next;
     SQL.Field(Self.FModel.modelo_contrato_locacao).Next;
     SQL.Field(Self.FModel.elimina_zero).Next;
     SQL.Field(Self.FModel.eliminar_digito_fabricante).Next;
     SQL.Field(Self.FModel.cta_trocaproduto).Next;
     SQL.Field(Self.FModel.forma_pgto_compras).Next;
     SQL.Field(Self.FModel.cfop_tributado_interno).Next;
     SQL.Field(Self.FModel.cfop_tributado_externo).Next;
     SQL.Field(Self.FModel.cfop_subst_interno).Next;
     SQL.Field(Self.FModel.cfop_subst_externo).Next;
     SQL.Field(Self.FModel.cfop_naoincidencia_interno).Next;
     SQL.Field(Self.FModel.cfop_naoincidencia_externo).Next;
     SQL.Field(Self.FModel.cfop_isento_interno).Next;
     SQL.Field(Self.FModel.cfop_isento_externo).Next;
     SQL.Field(Self.FModel.cfop_tribpautafiscal_interno).Next;
     SQL.Field(Self.FModel.cfop_tribpautafiscal_externo).Next;
     SQL.Field(Self.FModel.parametro_troca).Next;
     SQL.Field(Self.FModel.cliente_consumidor).Next;
     SQL.Field(Self.FModel.cfop_devolucao_venda).Next;
     SQL.Field(Self.FModel.troca_nfe).Next;
     SQL.Field(Self.FModel.localizacao_orcamento).Next;
     SQL.Field(Self.FModel.produto_tributado).Next;
     SQL.Field(Self.FModel.produto_substituicao).Next;
     SQL.Field(Self.FModel.produto_isento).Next;
     SQL.Field(Self.FModel.produto_reducao).Next;
     SQL.Field(Self.FModel.hora_reducao_z).Next;
     SQL.Field(Self.FModel.buscar_ean_letra).Next;
     SQL.Field(Self.FModel.imprimir_cod_fabric_cupom).Next;
     SQL.Field(Self.FModel.remessa_antigo).Next;
     SQL.Field(Self.FModel.caixa_baixa_simples).Next;
     SQL.Field(Self.FModel.visualizacao_antecipada_locacao).Next;
     SQL.Field(Self.FModel.antecipar_locacao).Next;
     SQL.Field(Self.FModel.senha_usuario_quitar_contareceber).Next;
     SQL.Field(Self.FModel.conta_receber_sem_banco).Next;
     SQL.Field(Self.FModel.utilizar_caixa_exclusivo).Next;
     SQL.Field(Self.FModel.caixa_exclusivo).Next;
     SQL.Field(Self.FModel.tipo_entrada_compras).Next;
     SQL.Field(Self.FModel.cta_insumos).Next;
     SQL.Field(Self.FModel.cta_almoxarifado).Next;
     SQL.Field(Self.FModel.cta_pag_funcionario).Next;
     SQL.Field(Self.FModel.utilizar_controle_financeiro_comissao).Next;
     SQL.Field(Self.FModel.cta_cheque_emitido).Next;
     SQL.Field(Self.FModel.controle_fabricante).Next;
     SQL.Field(Self.FModel.desossa_aut).Next;
     SQL.Field(Self.FModel.movimento_food).Next;
     SQL.Field(Self.FModel.pesquisa_venda).Next;
     SQL.Field(Self.FModel.nfce).Next;
     SQL.Field(Self.FModel.trabalha_nfce).Next;
     SQL.Field(Self.FModel.tolerancia_ponto).Next;
     SQL.Field(Self.FModel.venda).Next;
     SQL.Field(Self.FModel.expedicao).Next;
     SQL.Field(Self.FModel.romaneio).Next;
     SQL.Field(Self.FModel.cotacaop).Next;
     SQL.Field(Self.FModel.cfop_venda_entrega_futura).Next;
     SQL.Field(Self.FModel.cfop_entrega_futura).Next;
     SQL.Field(Self.FModel.cfop_entrega_fut_fora_estado).Next;
     SQL.Field(Self.FModel.cfop_venda_fut_fora_estado).Next;
     SQL.Field(Self.FModel.relatorio_gerencia_servico).Next;
     SQL.Field(Self.FModel.pasta_xml).Next;
     SQL.Field(Self.FModel.imagem_fundo).Next;
     SQL.Field(Self.FModel.pasta_nfe).Next;
     SQL.Field(Self.FModel.regime_especial_st).Next;
     SQL.Field(Self.FModel.confissao_divida).Next;
     SQL.Field(Self.FModel.utiliza_duplicata_grande).Next;
     SQL.Field(Self.FModel.controla_serial_celular).Next;
     SQL.Field(Self.FModel.cfop_devolucao_compra_interestadual).Next;
     SQL.Field(Self.FModel.cfop_devolucao_venda_interestadual).Next;
     SQL.Field(Self.FModel.nota_promissoria).Next;
     SQL.Field(Self.FModel.explodir_kit).Next;
     SQL.Field(Self.FModel.estoque_subsequente).Next;
     SQL.Field(Self.FModel.validar_fornecedor).Next;
     SQL.Field(Self.FModel.os_sem_veiculo).Next;
     SQL.Field(Self.FModel.informar_cfop_saida).Next;
     SQL.Field(Self.FModel.cfop_transferencia).Next;
     SQL.Field(Self.FModel.cfop_transferencia_interestadual).Next;
     SQL.Field(Self.FModel.cfop_retorno_mercadoria).Next;
     SQL.Field(Self.FModel.cfop_retorno_mercadoria_interestadual).Next;
     SQL.Field(Self.FModel.cfop_entrada_produto).Next;
     SQL.Field(Self.FModel.cfop_entrada_produto_interestadual).Next;
     SQL.Field(Self.FModel.validar_cliente).Next;
     SQL.Field(Self.FModel.imagem_tela_inicial).Next;
     SQL.Field(Self.FModel.kit_baixar_filhos).Next;
     SQL.Field(Self.FModel.padrao_central_custodia).Next;
     SQL.Field(Self.FModel.tipo_balanca).Next;
     SQL.Field(Self.FModel.path_balanca).Next;
     SQL.Field(Self.FModel.filial_produtos).Next;
     SQL.Field(Self.FModel.filial_clientes).Next;
     SQL.Field(Self.FModel.filial_fornecedor).Next;
     SQL.Field(Self.FModel.host_matriz).Next;
     SQL.Field(Self.FModel.faturar_aluguel_locacao).Next;
     SQL.Field(Self.FModel.cta_imposto_sindicato).Next;
     SQL.Field(Self.FModel.cta_imposto_inss).Next;
     SQL.Field(Self.FModel.lancamento_inss_sindicato).Next;
     SQL.Field(Self.FModel.parceiro_conta_pagar).Next;
     SQL.Field(Self.FModel.troco_troca).Next;
     SQL.Field(Self.FModel.movimentacao_data_saida).Next;
     SQL.Field(Self.FModel.salto_orcamento).Next;
     SQL.Field(Self.FModel.senhas_criptografadas).Next;
     SQL.Field(Self.FModel.qtd_produtos_orcamento).Next;
     SQL.Field(Self.FModel.qtd_servico_orcamento).Next;
     SQL.Field(Self.FModel.numero_pag_orcamento).Next;
     SQL.Field(Self.FModel.icms2016).Next;
     SQL.Field(Self.FModel.plano_conta_13digitos).Next;
     SQL.Field(Self.FModel.consulta_produto_especifico).Next;
     SQL.Field(Self.FModel.reducao_nfe).Next;
     SQL.Field(Self.FModel.informa_venda_em_aberto).Next;
     SQL.Field(Self.FModel.conversao_sped_simples_nacional).Next;
     SQL.Field(Self.FModel.visualizar_vendas).Next;
     SQL.Field(Self.FModel.acrescimo_frete).Next;
     SQL.Field(Self.FModel.pasta_retorno).Next;
     SQL.Field(Self.FModel.data_hora_nfe).Next;
     SQL.Field(Self.FModel.email_nfe).Next;
     SQL.Field(Self.FModel.motorista).Next;
     SQL.Field(Self.FModel.orcamento_peso_bruto).Next;
     SQL.Field(Self.FModel.mensagem_carne).Next;
     SQL.Field(Self.FModel.banco_contas_fixas).Next;
     SQL.Field(Self.FModel.cpf).Next;
     SQL.Field(Self.FModel.juros_mes).Next;
     SQL.Field(Self.FModel.cidade).Next;
     SQL.Field(Self.FModel.cte).Next;
     SQL.Field(Self.FModel.simples_subst).Next;
     SQL.Field(Self.FModel.cta_contas_fixas).Next;
     SQL.Field(Self.FModel.seq_lote).Next;
     SQL.Field(Self.FModel.numero_filial).Next;
     SQL.Field(Self.FModel.data_base_matriz).Next;
     SQL.Field(Self.FModel.filial_documentos).Next;
     SQL.Field(Self.FModel.cta_vendacredito_cliente).Next;
     SQL.Field(Self.FModel.cta_geracaocredito_cliente).Next;
     SQL.Field(Self.FModel.cta_recebimento_duplicata_credito_cliente).Next;
     SQL.Field(Self.FModel.cta_estorno_credito_cliente).Next;
     SQL.Field(Self.FModel.timezone).Next;
     SQL.Field(Self.FModel.timezone_utc).Next;
  dbInsert;
  Result := (ListError.Count = 0); 
end; 

function TDalERPefd.Select(Model: TModelBase; 
  out ModelList: TModelBaseList<TModelBase>): Boolean;         
var                                                            
  I : Integer;                                                 
begin                                                          
  if not (Model is TModelERPefd) then         
  begin                                                        
    ListError.Insert('Data Acess Layer','Tipo de dado incorreto ou Modelo (%s) Não Inicializado!', Self.ClassName); 
    Result := (ListError.Count = 0);                           
    Exit;                                                      
  end;                                                         

  Self.FModel := ( Model as TModelERPefd );   
  if Length( Trim( Ordem ) ) = 0 then  
    Ordem := 'id';                   
  if not Assigned( Self.FModel ) then  
  begin                                
    ListError.Insert('Data Acess Layer','Modelo (%s) Não Inicializado!', Self.ClassName);  
    Result := (ListError.Count = 0);   
    Exit;                              
  end;                                 

  SQL.SelectFrom(empresas);

  if Self.FModel.id > 0 then                   
    SQL.Where('id').Equal( Self.FModel.id ); 
  SQL.Order_By(Ordem);                         
  dbSelect;                                    

  if ListError.Count = 0 then                  
  begin                                        
    if Assigned( ModelList ) then              
      FreeAndNil( ModelList );                 

    Self.FModelList := TModelBaseList<TModelERPefd>.Create;  
    Self.FModelList.FieldCount := SQL.DataSet.FieldList.Count;               

    while ( not SQL.DataSet.Eof ) do 
    begin                            
      I := Self.FModelList.Add( TModelERPefd.Create ); 
      Self.FModelList[I].id      := SQL.getInteger(id);
      Self.FModelList[I].nome      := SQL.getInteger(nome);
      Self.FModelList[I].endereco      := SQL.getInteger(endereco);
      Self.FModelList[I].cnpj      := SQL.getInteger(cnpj);
      Self.FModelList[I].inscricao_estadual      := SQL.getInteger(inscricao_estadual);
      Self.FModelList[I].fone1      := SQL.getInteger(fone1);
      Self.FModelList[I].fone2      := SQL.getInteger(fone2);
      Self.FModelList[I].fax      := SQL.getInteger(fax);
      Self.FModelList[I].bairro      := SQL.getInteger(bairro);
      Self.FModelList[I].id_cidade      := SQL.getInteger(id_cidade);
      Self.FModelList[I].uf      := SQL.getInteger(uf);
      Self.FModelList[I].representante_legal      := SQL.getInteger(representante_legal);
      Self.FModelList[I].tipo_empresa      := SQL.getInteger(tipo_empresa);
      Self.FModelList[I].hostname      := SQL.getInteger(hostname);
      Self.FModelList[I].database      := SQL.getInteger(database);
      Self.FModelList[I].porta      := SQL.getInteger(porta);
      Self.FModelList[I].usuariodbms      := SQL.getInteger(usuariodbms);
      Self.FModelList[I].senhadbms      := SQL.getInteger(senhadbms);
      Self.FModelList[I].data_cadastro      := SQL.getInteger(data_cadastro);
      Self.FModelList[I].cta_vendas      := SQL.getInteger(cta_vendas);
      Self.FModelList[I].cta_compra      := SQL.getInteger(cta_compra);
      Self.FModelList[I].cta_recparcela      := SQL.getInteger(cta_recparcela);
      Self.FModelList[I].cta_estparcela      := SQL.getInteger(cta_estparcela);
      Self.FModelList[I].cta_pagparcela      := SQL.getInteger(cta_pagparcela);
      Self.FModelList[I].cta_depbancario      := SQL.getInteger(cta_depbancario);
      Self.FModelList[I].cta_emissaocheq      := SQL.getInteger(cta_emissaocheq);
      Self.FModelList[I].cta_estcaixa      := SQL.getInteger(cta_estcaixa);
      Self.FModelList[I].cta_estbanco      := SQL.getInteger(cta_estbanco);
      Self.FModelList[I].cta_jrorecebido      := SQL.getInteger(cta_jrorecebido);
      Self.FModelList[I].cta_jropago      := SQL.getInteger(cta_jropago);
      Self.FModelList[I].cta_descrecebido      := SQL.getInteger(cta_descrecebido);
      Self.FModelList[I].cta_descpago      := SQL.getInteger(cta_descpago);
      Self.FModelList[I].cta_devolvenda      := SQL.getInteger(cta_devolvenda);
      Self.FModelList[I].desc_rateio      := SQL.getInteger(desc_rateio);
      Self.FModelList[I].mensagem_promocional      := SQL.getInteger(mensagem_promocional);
      Self.FModelList[I].modelo_duplicata      := SQL.getInteger(modelo_duplicata);
      Self.FModelList[I].modelo_recibo      := SQL.getInteger(modelo_recibo);
      Self.FModelList[I].modelo_nota      := SQL.getInteger(modelo_nota);
      Self.FModelList[I].qtd_itensnota      := SQL.getInteger(qtd_itensnota);
      Self.FModelList[I].tam_pagnota      := SQL.getInteger(tam_pagnota);
      Self.FModelList[I].seq_nronota      := SQL.getInteger(seq_nronota);
      Self.FModelList[I].imprime_nota      := SQL.getInteger(imprime_nota);
      Self.FModelList[I].imprime_vendedor      := SQL.getInteger(imprime_vendedor);
      Self.FModelList[I].estoque_negativo      := SQL.getInteger(estoque_negativo);
      Self.FModelList[I].texto_cobranca      := SQL.getInteger(texto_cobranca);
      Self.FModelList[I].custo_operacional      := SQL.getInteger(custo_operacional);
      Self.FModelList[I].custo_financeiro      := SQL.getInteger(custo_financeiro);
      Self.FModelList[I].juro_dia      := SQL.getInteger(juro_dia);
      Self.FModelList[I].cfop_avista      := SQL.getInteger(cfop_avista);
      Self.FModelList[I].cfop_aprazo      := SQL.getInteger(cfop_aprazo);
      Self.FModelList[I].click      := SQL.getInteger(click);
      Self.FModelList[I].salto_nota      := SQL.getInteger(salto_nota);
      Self.FModelList[I].caminho_nota      := SQL.getInteger(caminho_nota);
      Self.FModelList[I].cotacao      := SQL.getInteger(cotacao);
      Self.FModelList[I].comissao_decrescente      := SQL.getInteger(comissao_decrescente);
      Self.FModelList[I].intervalo_a1      := SQL.getInteger(intervalo_a1);
      Self.FModelList[I].intervalo_a2      := SQL.getInteger(intervalo_a2);
      Self.FModelList[I].intervalo_b1      := SQL.getInteger(intervalo_b1);
      Self.FModelList[I].intervalo_b2      := SQL.getInteger(intervalo_b2);
      Self.FModelList[I].intervalo_c1      := SQL.getInteger(intervalo_c1);
      Self.FModelList[I].intervalo_c2      := SQL.getInteger(intervalo_c2);
      Self.FModelList[I].intervalo_d1      := SQL.getInteger(intervalo_d1);
      Self.FModelList[I].intervalo_d2      := SQL.getInteger(intervalo_d2);
      Self.FModelList[I].intervalo_e1      := SQL.getInteger(intervalo_e1);
      Self.FModelList[I].intervalo_f1      := SQL.getInteger(intervalo_f1);
      Self.FModelList[I].intervalo_f2      := SQL.getInteger(intervalo_f2);
      Self.FModelList[I].intervalo_g1      := SQL.getInteger(intervalo_g1);
      Self.FModelList[I].intervalo_g2      := SQL.getInteger(intervalo_g2);
      Self.FModelList[I].intervalo_h1      := SQL.getInteger(intervalo_h1);
      Self.FModelList[I].intervalo_h2      := SQL.getInteger(intervalo_h2);
      Self.FModelList[I].intervalo_i1      := SQL.getInteger(intervalo_i1);
      Self.FModelList[I].intervalo_i2      := SQL.getInteger(intervalo_i2);
      Self.FModelList[I].intervalo_j1      := SQL.getInteger(intervalo_j1);
      Self.FModelList[I].intervalo_j2      := SQL.getInteger(intervalo_j2);
      Self.FModelList[I].intervalo_l1      := SQL.getInteger(intervalo_l1);
      Self.FModelList[I].intervalo_l2      := SQL.getInteger(intervalo_l2);
      Self.FModelList[I].intervalo_m1      := SQL.getInteger(intervalo_m1);
      Self.FModelList[I].intervalo_m2      := SQL.getInteger(intervalo_m2);
      Self.FModelList[I].comissao_a      := SQL.getInteger(comissao_a);
      Self.FModelList[I].comissao_b      := SQL.getInteger(comissao_b);
      Self.FModelList[I].comissao_c      := SQL.getInteger(comissao_c);
      Self.FModelList[I].comissao_d      := SQL.getInteger(comissao_d);
      Self.FModelList[I].comissao_e      := SQL.getInteger(comissao_e);
      Self.FModelList[I].comissao_f      := SQL.getInteger(comissao_f);
      Self.FModelList[I].comissao_g      := SQL.getInteger(comissao_g);
      Self.FModelList[I].comissao_h      := SQL.getInteger(comissao_h);
      Self.FModelList[I].comissao_i      := SQL.getInteger(comissao_i);
      Self.FModelList[I].comissao_j      := SQL.getInteger(comissao_j);
      Self.FModelList[I].comissao_l      := SQL.getInteger(comissao_l);
      Self.FModelList[I].comissao_m      := SQL.getInteger(comissao_m);
      Self.FModelList[I].intervalo_e2      := SQL.getInteger(intervalo_e2);
      Self.FModelList[I].salto_duplicata      := SQL.getInteger(salto_duplicata);
      Self.FModelList[I].imagem      := SQL.getInteger(imagem);
      Self.FModelList[I].arquivo_imagem      := SQL.getInteger(arquivo_imagem);
      Self.FModelList[I].produto_conjugado      := SQL.getInteger(produto_conjugado);
      Self.FModelList[I].rateio_comissao      := SQL.getInteger(rateio_comissao);
      Self.FModelList[I].cta_vendas_aprazo      := SQL.getInteger(cta_vendas_aprazo);
      Self.FModelList[I].formacao_preco      := SQL.getInteger(formacao_preco);
      Self.FModelList[I].nosso_numero      := SQL.getInteger(nosso_numero);
      Self.FModelList[I].identifica_cupom      := SQL.getInteger(identifica_cupom);
      Self.FModelList[I].atividade      := SQL.getInteger(atividade);
      Self.FModelList[I].venda_rapida      := SQL.getInteger(venda_rapida);
      Self.FModelList[I].grade      := SQL.getInteger(grade);
      Self.FModelList[I].data_analise      := SQL.getInteger(data_analise);
      Self.FModelList[I].cta_suprimento      := SQL.getInteger(cta_suprimento);
      Self.FModelList[I].cta_sangria      := SQL.getInteger(cta_sangria);
      Self.FModelList[I].cta_os      := SQL.getInteger(cta_os);
      Self.FModelList[I].bancocodigo      := SQL.getInteger(bancocodigo);
      Self.FModelList[I].banconome      := SQL.getInteger(banconome);
      Self.FModelList[I].cedentecodigo      := SQL.getInteger(cedentecodigo);
      Self.FModelList[I].cedentecodigodigito      := SQL.getInteger(cedentecodigodigito);
      Self.FModelList[I].carteira      := SQL.getInteger(carteira);
      Self.FModelList[I].agenciacodigo      := SQL.getInteger(agenciacodigo);
      Self.FModelList[I].agenciadigito      := SQL.getInteger(agenciadigito);
      Self.FModelList[I].agencianome      := SQL.getInteger(agencianome);
      Self.FModelList[I].contanumero      := SQL.getInteger(contanumero);
      Self.FModelList[I].contanumerodigito      := SQL.getInteger(contanumerodigito);
      Self.FModelList[I].proximonossonumero      := SQL.getInteger(proximonossonumero);
      Self.FModelList[I].salto_etiqueta1      := SQL.getInteger(salto_etiqueta1);
      Self.FModelList[I].salto_etiqueta2      := SQL.getInteger(salto_etiqueta2);
      Self.FModelList[I].salto_etiqueta3      := SQL.getInteger(salto_etiqueta3);
      Self.FModelList[I].salto_etiqueta4      := SQL.getInteger(salto_etiqueta4);
      Self.FModelList[I].filtro_nome      := SQL.getInteger(filtro_nome);
      Self.FModelList[I].dir_sistema      := SQL.getInteger(dir_sistema);
      Self.FModelList[I].dir_banco      := SQL.getInteger(dir_banco);
      Self.FModelList[I].valorreceber_maior      := SQL.getInteger(valorreceber_maior);
      Self.FModelList[I].cfop_devolucao      := SQL.getInteger(cfop_devolucao);
      Self.FModelList[I].devolucao_financeiro      := SQL.getInteger(devolucao_financeiro);
      Self.FModelList[I].vendedor_venda      := SQL.getInteger(vendedor_venda);
      Self.FModelList[I].instrucoes      := SQL.getInteger(instrucoes);
      Self.FModelList[I].forma_boleto      := SQL.getInteger(forma_boleto);
      Self.FModelList[I].cupom_automatico      := SQL.getInteger(cupom_automatico);
      Self.FModelList[I].simples      := SQL.getInteger(simples);
      Self.FModelList[I].vl_enc_federal      := SQL.getInteger(vl_enc_federal);
      Self.FModelList[I].vl_enc_estadual      := SQL.getInteger(vl_enc_estadual);
      Self.FModelList[I].convenio      := SQL.getInteger(convenio);
      Self.FModelList[I].tipo_convenio      := SQL.getInteger(tipo_convenio);
      Self.FModelList[I].dir_backup      := SQL.getInteger(dir_backup);
      Self.FModelList[I].modelo_carne      := SQL.getInteger(modelo_carne);
      Self.FModelList[I].iss      := SQL.getInteger(iss);
      Self.FModelList[I].qtd_itensnotaservico      := SQL.getInteger(qtd_itensnotaservico);
      Self.FModelList[I].texto_aniversario      := SQL.getInteger(texto_aniversario);
      Self.FModelList[I].ordemproc_produto      := SQL.getInteger(ordemproc_produto);
      Self.FModelList[I].extrato_produto      := SQL.getInteger(extrato_produto);
      Self.FModelList[I].boleto      := SQL.getInteger(boleto);
      Self.FModelList[I].salto_boleto      := SQL.getInteger(salto_boleto);
      Self.FModelList[I].cliente_coringa      := SQL.getInteger(cliente_coringa);
      Self.FModelList[I].mostra_conta      := SQL.getInteger(mostra_conta);
      Self.FModelList[I].numero      := SQL.getInteger(numero);
      Self.FModelList[I].cep      := SQL.getInteger(cep);
      Self.FModelList[I].responsavel      := SQL.getInteger(responsavel);
      Self.FModelList[I].st      := SQL.getInteger(st);
      Self.FModelList[I].ipi      := SQL.getInteger(ipi);
      Self.FModelList[I].industria      := SQL.getInteger(industria);
      Self.FModelList[I].locacao      := SQL.getInteger(locacao);
      Self.FModelList[I].obs_orcamento      := SQL.getInteger(obs_orcamento);
      Self.FModelList[I].insc_mun      := SQL.getInteger(insc_mun);
      Self.FModelList[I].nfe      := SQL.getInteger(nfe);
      Self.FModelList[I].supervisor      := SQL.getInteger(supervisor);
      Self.FModelList[I].salto_etiqueta5      := SQL.getInteger(salto_etiqueta5);
      Self.FModelList[I].juro_carencia      := SQL.getInteger(juro_carencia);
      Self.FModelList[I].baixa_simples      := SQL.getInteger(baixa_simples);
      Self.FModelList[I].obs_carne1      := SQL.getInteger(obs_carne1);
      Self.FModelList[I].obs_carne2      := SQL.getInteger(obs_carne2);
      Self.FModelList[I].obs_carne3      := SQL.getInteger(obs_carne3);
      Self.FModelList[I].obs_carne4      := SQL.getInteger(obs_carne4);
      Self.FModelList[I].obs_carne5      := SQL.getInteger(obs_carne5);
      Self.FModelList[I].obs_carne6      := SQL.getInteger(obs_carne6);
      Self.FModelList[I].venda_maior      := SQL.getInteger(venda_maior);
      Self.FModelList[I].substituto_tributario      := SQL.getInteger(substituto_tributario);
      Self.FModelList[I].diretorio_fotos      := SQL.getInteger(diretorio_fotos);
      Self.FModelList[I].obs_carne7      := SQL.getInteger(obs_carne7);
      Self.FModelList[I].obs_carne8      := SQL.getInteger(obs_carne8);
      Self.FModelList[I].modelo_ficha      := SQL.getInteger(modelo_ficha);
      Self.FModelList[I].pis      := SQL.getInteger(pis);
      Self.FModelList[I].cofins      := SQL.getInteger(cofins);
      Self.FModelList[I].ajusta_fatura      := SQL.getInteger(ajusta_fatura);
      Self.FModelList[I].simples_nacional      := SQL.getInteger(simples_nacional);
      Self.FModelList[I].produto_consulta      := SQL.getInteger(produto_consulta);
      Self.FModelList[I].modelo_orcamento      := SQL.getInteger(modelo_orcamento);
      Self.FModelList[I].modelo_expedicao      := SQL.getInteger(modelo_expedicao);
      Self.FModelList[I].dias_backup      := SQL.getInteger(dias_backup);
      Self.FModelList[I].imprime_notad1      := SQL.getInteger(imprime_notad1);
      Self.FModelList[I].farmacia_popular      := SQL.getInteger(farmacia_popular);
      Self.FModelList[I].fpb      := SQL.getInteger(fpb);
      Self.FModelList[I].irpj      := SQL.getInteger(irpj);
      Self.FModelList[I].cont_social      := SQL.getInteger(cont_social);
      Self.FModelList[I].casas_decimais      := SQL.getInteger(casas_decimais);
      Self.FModelList[I].tipo_desconto      := SQL.getInteger(tipo_desconto);
      Self.FModelList[I].custo_servico      := SQL.getInteger(custo_servico);
      Self.FModelList[I].tipo_juro_venda      := SQL.getInteger(tipo_juro_venda);
      Self.FModelList[I].bloqueio_automatico      := SQL.getInteger(bloqueio_automatico);
      Self.FModelList[I].controle_caixa      := SQL.getInteger(controle_caixa);
      Self.FModelList[I].tipo_juro      := SQL.getInteger(tipo_juro);
      Self.FModelList[I].aproveitamento_credito_atacado      := SQL.getInteger(aproveitamento_credito_atacado);
      Self.FModelList[I].icms_saida      := SQL.getInteger(icms_saida);
      Self.FModelList[I].compras_red_fora      := SQL.getInteger(compras_red_fora);
      Self.FModelList[I].compras_red_dentro      := SQL.getInteger(compras_red_dentro);
      Self.FModelList[I].atacado      := SQL.getInteger(atacado);
      Self.FModelList[I].aprazo      := SQL.getInteger(aprazo);
      Self.FModelList[I].id_tabela_preco      := SQL.getInteger(id_tabela_preco);
      Self.FModelList[I].multa      := SQL.getInteger(multa);
      Self.FModelList[I].tributado      := SQL.getInteger(tributado);
      Self.FModelList[I].substituicao      := SQL.getInteger(substituicao);
      Self.FModelList[I].isento      := SQL.getInteger(isento);
      Self.FModelList[I].reducao      := SQL.getInteger(reducao);
      Self.FModelList[I].credencial      := SQL.getInteger(credencial);
      Self.FModelList[I].controleestoquevenda      := SQL.getInteger(controleestoquevenda);
      Self.FModelList[I].cta_transf_saida      := SQL.getInteger(cta_transf_saida);
      Self.FModelList[I].cta_transf_entrada      := SQL.getInteger(cta_transf_entrada);
      Self.FModelList[I].cta_estorno_emissao_cheque      := SQL.getInteger(cta_estorno_emissao_cheque);
      Self.FModelList[I].cta_custodia      := SQL.getInteger(cta_custodia);
      Self.FModelList[I].cta_estorno_custodia      := SQL.getInteger(cta_estorno_custodia);
      Self.FModelList[I].cta_juros_custodia      := SQL.getInteger(cta_juros_custodia);
      Self.FModelList[I].cta_estorno_juros_custodia      := SQL.getInteger(cta_estorno_juros_custodia);
      Self.FModelList[I].cta_estorno_pagamento      := SQL.getInteger(cta_estorno_pagamento);
      Self.FModelList[I].cta_taxa_juros      := SQL.getInteger(cta_taxa_juros);
      Self.FModelList[I].razao_social      := SQL.getInteger(razao_social);
      Self.FModelList[I].celular      := SQL.getInteger(celular);
      Self.FModelList[I].contato      := SQL.getInteger(contato);
      Self.FModelList[I].parceiro      := SQL.getInteger(parceiro);
      Self.FModelList[I].cta_recebimento_cartao      := SQL.getInteger(cta_recebimento_cartao);
      Self.FModelList[I].obs_promissoria      := SQL.getInteger(obs_promissoria);
      Self.FModelList[I].boleto_novo      := SQL.getInteger(boleto_novo);
      Self.FModelList[I].modelo_contrato_locacao      := SQL.getInteger(modelo_contrato_locacao);
      Self.FModelList[I].elimina_zero      := SQL.getInteger(elimina_zero);
      Self.FModelList[I].eliminar_digito_fabricante      := SQL.getInteger(eliminar_digito_fabricante);
      Self.FModelList[I].cta_trocaproduto      := SQL.getInteger(cta_trocaproduto);
      Self.FModelList[I].forma_pgto_compras      := SQL.getInteger(forma_pgto_compras);
      Self.FModelList[I].cfop_tributado_interno      := SQL.getInteger(cfop_tributado_interno);
      Self.FModelList[I].cfop_tributado_externo      := SQL.getInteger(cfop_tributado_externo);
      Self.FModelList[I].cfop_subst_interno      := SQL.getInteger(cfop_subst_interno);
      Self.FModelList[I].cfop_subst_externo      := SQL.getInteger(cfop_subst_externo);
      Self.FModelList[I].cfop_naoincidencia_interno      := SQL.getInteger(cfop_naoincidencia_interno);
      Self.FModelList[I].cfop_naoincidencia_externo      := SQL.getInteger(cfop_naoincidencia_externo);
      Self.FModelList[I].cfop_isento_interno      := SQL.getInteger(cfop_isento_interno);
      Self.FModelList[I].cfop_isento_externo      := SQL.getInteger(cfop_isento_externo);
      Self.FModelList[I].cfop_tribpautafiscal_interno      := SQL.getInteger(cfop_tribpautafiscal_interno);
      Self.FModelList[I].cfop_tribpautafiscal_externo      := SQL.getInteger(cfop_tribpautafiscal_externo);
      Self.FModelList[I].parametro_troca      := SQL.getInteger(parametro_troca);
      Self.FModelList[I].cliente_consumidor      := SQL.getInteger(cliente_consumidor);
      Self.FModelList[I].cfop_devolucao_venda      := SQL.getInteger(cfop_devolucao_venda);
      Self.FModelList[I].troca_nfe      := SQL.getInteger(troca_nfe);
      Self.FModelList[I].localizacao_orcamento      := SQL.getInteger(localizacao_orcamento);
      Self.FModelList[I].produto_tributado      := SQL.getInteger(produto_tributado);
      Self.FModelList[I].produto_substituicao      := SQL.getInteger(produto_substituicao);
      Self.FModelList[I].produto_isento      := SQL.getInteger(produto_isento);
      Self.FModelList[I].produto_reducao      := SQL.getInteger(produto_reducao);
      Self.FModelList[I].hora_reducao_z      := SQL.getInteger(hora_reducao_z);
      Self.FModelList[I].buscar_ean_letra      := SQL.getInteger(buscar_ean_letra);
      Self.FModelList[I].imprimir_cod_fabric_cupom      := SQL.getInteger(imprimir_cod_fabric_cupom);
      Self.FModelList[I].remessa_antigo      := SQL.getInteger(remessa_antigo);
      Self.FModelList[I].caixa_baixa_simples      := SQL.getInteger(caixa_baixa_simples);
      Self.FModelList[I].visualizacao_antecipada_locacao      := SQL.getInteger(visualizacao_antecipada_locacao);
      Self.FModelList[I].antecipar_locacao      := SQL.getInteger(antecipar_locacao);
      Self.FModelList[I].senha_usuario_quitar_contareceber      := SQL.getInteger(senha_usuario_quitar_contareceber);
      Self.FModelList[I].conta_receber_sem_banco      := SQL.getInteger(conta_receber_sem_banco);
      Self.FModelList[I].utilizar_caixa_exclusivo      := SQL.getInteger(utilizar_caixa_exclusivo);
      Self.FModelList[I].caixa_exclusivo      := SQL.getInteger(caixa_exclusivo);
      Self.FModelList[I].tipo_entrada_compras      := SQL.getInteger(tipo_entrada_compras);
      Self.FModelList[I].cta_insumos      := SQL.getInteger(cta_insumos);
      Self.FModelList[I].cta_almoxarifado      := SQL.getInteger(cta_almoxarifado);
      Self.FModelList[I].cta_pag_funcionario      := SQL.getInteger(cta_pag_funcionario);
      Self.FModelList[I].utilizar_controle_financeiro_comissao      := SQL.getInteger(utilizar_controle_financeiro_comissao);
      Self.FModelList[I].cta_cheque_emitido      := SQL.getInteger(cta_cheque_emitido);
      Self.FModelList[I].controle_fabricante      := SQL.getInteger(controle_fabricante);
      Self.FModelList[I].desossa_aut      := SQL.getInteger(desossa_aut);
      Self.FModelList[I].movimento_food      := SQL.getInteger(movimento_food);
      Self.FModelList[I].pesquisa_venda      := SQL.getInteger(pesquisa_venda);
      Self.FModelList[I].nfce      := SQL.getInteger(nfce);
      Self.FModelList[I].trabalha_nfce      := SQL.getInteger(trabalha_nfce);
      Self.FModelList[I].tolerancia_ponto      := SQL.getInteger(tolerancia_ponto);
      Self.FModelList[I].venda      := SQL.getInteger(venda);
      Self.FModelList[I].expedicao      := SQL.getInteger(expedicao);
      Self.FModelList[I].romaneio      := SQL.getInteger(romaneio);
      Self.FModelList[I].cotacaop      := SQL.getInteger(cotacaop);
      Self.FModelList[I].cfop_venda_entrega_futura      := SQL.getInteger(cfop_venda_entrega_futura);
      Self.FModelList[I].cfop_entrega_futura      := SQL.getInteger(cfop_entrega_futura);
      Self.FModelList[I].cfop_entrega_fut_fora_estado      := SQL.getInteger(cfop_entrega_fut_fora_estado);
      Self.FModelList[I].cfop_venda_fut_fora_estado      := SQL.getInteger(cfop_venda_fut_fora_estado);
      Self.FModelList[I].relatorio_gerencia_servico      := SQL.getInteger(relatorio_gerencia_servico);
      Self.FModelList[I].pasta_xml      := SQL.getInteger(pasta_xml);
      Self.FModelList[I].imagem_fundo      := SQL.getInteger(imagem_fundo);
      Self.FModelList[I].pasta_nfe      := SQL.getInteger(pasta_nfe);
      Self.FModelList[I].regime_especial_st      := SQL.getInteger(regime_especial_st);
      Self.FModelList[I].confissao_divida      := SQL.getInteger(confissao_divida);
      Self.FModelList[I].utiliza_duplicata_grande      := SQL.getInteger(utiliza_duplicata_grande);
      Self.FModelList[I].controla_serial_celular      := SQL.getInteger(controla_serial_celular);
      Self.FModelList[I].cfop_devolucao_compra_interestadual      := SQL.getInteger(cfop_devolucao_compra_interestadual);
      Self.FModelList[I].cfop_devolucao_venda_interestadual      := SQL.getInteger(cfop_devolucao_venda_interestadual);
      Self.FModelList[I].nota_promissoria      := SQL.getInteger(nota_promissoria);
      Self.FModelList[I].explodir_kit      := SQL.getInteger(explodir_kit);
      Self.FModelList[I].estoque_subsequente      := SQL.getInteger(estoque_subsequente);
      Self.FModelList[I].validar_fornecedor      := SQL.getInteger(validar_fornecedor);
      Self.FModelList[I].os_sem_veiculo      := SQL.getInteger(os_sem_veiculo);
      Self.FModelList[I].informar_cfop_saida      := SQL.getInteger(informar_cfop_saida);
      Self.FModelList[I].cfop_transferencia      := SQL.getInteger(cfop_transferencia);
      Self.FModelList[I].cfop_transferencia_interestadual      := SQL.getInteger(cfop_transferencia_interestadual);
      Self.FModelList[I].cfop_retorno_mercadoria      := SQL.getInteger(cfop_retorno_mercadoria);
      Self.FModelList[I].cfop_retorno_mercadoria_interestadual      := SQL.getInteger(cfop_retorno_mercadoria_interestadual);
      Self.FModelList[I].cfop_entrada_produto      := SQL.getInteger(cfop_entrada_produto);
      Self.FModelList[I].cfop_entrada_produto_interestadual      := SQL.getInteger(cfop_entrada_produto_interestadual);
      Self.FModelList[I].validar_cliente      := SQL.getInteger(validar_cliente);
      Self.FModelList[I].imagem_tela_inicial      := SQL.getInteger(imagem_tela_inicial);
      Self.FModelList[I].kit_baixar_filhos      := SQL.getInteger(kit_baixar_filhos);
      Self.FModelList[I].padrao_central_custodia      := SQL.getInteger(padrao_central_custodia);
      Self.FModelList[I].tipo_balanca      := SQL.getInteger(tipo_balanca);
      Self.FModelList[I].path_balanca      := SQL.getInteger(path_balanca);
      Self.FModelList[I].filial_produtos      := SQL.getInteger(filial_produtos);
      Self.FModelList[I].filial_clientes      := SQL.getInteger(filial_clientes);
      Self.FModelList[I].filial_fornecedor      := SQL.getInteger(filial_fornecedor);
      Self.FModelList[I].host_matriz      := SQL.getInteger(host_matriz);
      Self.FModelList[I].faturar_aluguel_locacao      := SQL.getInteger(faturar_aluguel_locacao);
      Self.FModelList[I].cta_imposto_sindicato      := SQL.getInteger(cta_imposto_sindicato);
      Self.FModelList[I].cta_imposto_inss      := SQL.getInteger(cta_imposto_inss);
      Self.FModelList[I].lancamento_inss_sindicato      := SQL.getInteger(lancamento_inss_sindicato);
      Self.FModelList[I].parceiro_conta_pagar      := SQL.getInteger(parceiro_conta_pagar);
      Self.FModelList[I].troco_troca      := SQL.getInteger(troco_troca);
      Self.FModelList[I].movimentacao_data_saida      := SQL.getInteger(movimentacao_data_saida);
      Self.FModelList[I].salto_orcamento      := SQL.getInteger(salto_orcamento);
      Self.FModelList[I].senhas_criptografadas      := SQL.getInteger(senhas_criptografadas);
      Self.FModelList[I].qtd_produtos_orcamento      := SQL.getInteger(qtd_produtos_orcamento);
      Self.FModelList[I].qtd_servico_orcamento      := SQL.getInteger(qtd_servico_orcamento);
      Self.FModelList[I].numero_pag_orcamento      := SQL.getInteger(numero_pag_orcamento);
      Self.FModelList[I].icms2016      := SQL.getInteger(icms2016);
      Self.FModelList[I].plano_conta_13digitos      := SQL.getInteger(plano_conta_13digitos);
      Self.FModelList[I].consulta_produto_especifico      := SQL.getInteger(consulta_produto_especifico);
      Self.FModelList[I].reducao_nfe      := SQL.getInteger(reducao_nfe);
      Self.FModelList[I].informa_venda_em_aberto      := SQL.getInteger(informa_venda_em_aberto);
      Self.FModelList[I].conversao_sped_simples_nacional      := SQL.getInteger(conversao_sped_simples_nacional);
      Self.FModelList[I].visualizar_vendas      := SQL.getInteger(visualizar_vendas);
      Self.FModelList[I].acrescimo_frete      := SQL.getInteger(acrescimo_frete);
      Self.FModelList[I].pasta_retorno      := SQL.getInteger(pasta_retorno);
      Self.FModelList[I].data_hora_nfe      := SQL.getInteger(data_hora_nfe);
      Self.FModelList[I].email_nfe      := SQL.getInteger(email_nfe);
      Self.FModelList[I].motorista      := SQL.getInteger(motorista);
      Self.FModelList[I].orcamento_peso_bruto      := SQL.getInteger(orcamento_peso_bruto);
      Self.FModelList[I].mensagem_carne      := SQL.getInteger(mensagem_carne);
      Self.FModelList[I].banco_contas_fixas      := SQL.getInteger(banco_contas_fixas);
      Self.FModelList[I].cpf      := SQL.getInteger(cpf);
      Self.FModelList[I].juros_mes      := SQL.getInteger(juros_mes);
      Self.FModelList[I].cidade      := SQL.getInteger(cidade);
      Self.FModelList[I].cte      := SQL.getInteger(cte);
      Self.FModelList[I].simples_subst      := SQL.getInteger(simples_subst);
      Self.FModelList[I].cta_contas_fixas      := SQL.getInteger(cta_contas_fixas);
      Self.FModelList[I].seq_lote      := SQL.getInteger(seq_lote);
      Self.FModelList[I].numero_filial      := SQL.getInteger(numero_filial);
      Self.FModelList[I].data_base_matriz      := SQL.getInteger(data_base_matriz);
      Self.FModelList[I].filial_documentos      := SQL.getInteger(filial_documentos);
      Self.FModelList[I].cta_vendacredito_cliente      := SQL.getInteger(cta_vendacredito_cliente);
      Self.FModelList[I].cta_geracaocredito_cliente      := SQL.getInteger(cta_geracaocredito_cliente);
      Self.FModelList[I].cta_recebimento_duplicata_credito_cliente      := SQL.getInteger(cta_recebimento_duplicata_credito_cliente);
      Self.FModelList[I].cta_estorno_credito_cliente      := SQL.getInteger(cta_estorno_credito_cliente);
      Self.FModelList[I].timezone      := SQL.getInteger(timezone);
      Self.FModelList[I].timezone_utc      := SQL.getInteger(timezone_utc);
      SQL.DataSet.Next;
    end;               
    Self.FModelList.TrimExcess; 
    ModelList := TModelBaseList<TModelBase>( Self.FModelList );
  end;                
  Result := ( ListError.Count = 0 ); 
end;   
function TDalERPNcmRegraSubstituicao.Update(Model: TModelBase): Boolean; 
begin                                                                    
  if not (Model is TModelERPNcmRegraSubstituicao) then                   
  begin                                                                  
    ListError.Insert('Data Acess Layer','Tipo de dado incorreto ou Modelo (%s) Não Inicializado!', Self.ClassName); 
    Result := (ListError.Count = 0);                                     
    Exit;                                                                
  end;                                                                   

  Self.FModel := ( Model as TModelERPefd );             

  if not Assigned( Self.FModel ) then  
  begin                                
    ListError.Insert('Data Acess Layer','Modelo (%s) Não Inicializado!', Self.ClassName); 
    Result := (ListError.Count = 0);   
    Exit;                              
  end;                                 

  if Self.FModel.id = 0 then           
  begin                                
    ListError.Insert('Atualização de registros','Parece que o modelo esta em Branco!');  
    Result := (ListError.Count = 0);   
    Exit;                              
  end;                                 
  if not Self.FModel.Validate then     
  begin                                
    ListError.Assign( Self.FModel.ListError ); 
    Result := (ListError.Count = 0);   
    Exit;                              
  end;                                 
  SQL.Update(empresas);

  dbUpdate; 

  Result := (ListError.Count = 0); 

end;

end. 
